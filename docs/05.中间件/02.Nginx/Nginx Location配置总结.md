语法规则： location [=|~|~*|^~] /uri/ { … }

- = 开头表示精确匹配
- ^~ 开头表示uri以某个常规字符串开头，理解为匹配 url路径即可。nginx不对url做编码，因此请求为/static/20%/aa，可以被规则^~ /static/ /aa匹配到（注意是空格）。
- ~ 开头表示区分大小写的正则匹配
- ~* 开头表示不区分大小写的正则匹配
- `!~`和`!~*`分别为区分大小写不匹配及不区分大小写不匹配 的正则
- / 通用匹配，任何请求都会匹配到。

匹配顺序为：

1. 匹配到全等匹配时，终止后续所有匹配，直接返回；
2. 步骤一未匹配上时，然后遍历所有的普通匹配，按照最长匹配原则找到最满足的匹配项，
    如果匹配项前面有^~符号，则终止后续正则匹配，采用该匹配项；反之则继续后续的正则匹配
3. 步骤一二都未匹配上时，此时进行正则匹配，找到第一个满足的正则匹配项，直接返回，若都不满足，则返回步骤二中的最长匹配项（所以说正则匹配和loaction的顺序有关系）



### 全等匹配：

	location = /static/img/ {
	   deny all;
	}
### 普通匹配：

	location /static/img/ {
	   deny all;
	}
	
	# 匹配到此类型时，终止后续的正则匹配（后面会有详细分析）
	location ^~ /static/img/ {
	   deny all;
	}
### 正则匹配：

	#正则不区分大小写
	location ~* /static/img/ {  
	   deny all;
	}
	#正则区分大小写
	location ~ /static/img/ {
	   deny all;
	}


## ReWrite语法

last – 基本上都用这个Flag。
break – 中止Rewirte，不在继续匹配
redirect – 返回临时重定向的HTTP状态302
permanent – 返回永久重定向的HTTP状态301